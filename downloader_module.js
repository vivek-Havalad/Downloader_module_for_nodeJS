var http=require("http"),fs=require("fs"),https=require("https"),https_download=function(t,n,o,i){https.get(t,function(t){t.pipe(o),o.on("finish",function(){o.end(i({ok:1}))})}).on("error",function(t){if(fs.unlink(n),i)return i(t.message)})},http_download=function(t,n,o,i){http.get(t,function(t){t.pipe(o),o.on("finish",function(){o.end(i({ok:2}))})}).on("error",function(t){if(fs.unlink(n),i)return i(t.message)})},download=function(t,n,o){var i=!0;"http"==t.split(":")[0]&&(i=!1);var e=t.split("/").pop().split("#")[0].split("?")[0];-1!=e.indexOf(":")&&(e=e.split(":")[1]),n=n+""+e;var r=fs.createWriteStream(n);i?https_download(t,n,r,o):http_download(t,n,r,o)};module.exports=download;
